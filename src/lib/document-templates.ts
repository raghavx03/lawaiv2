// Professional Indian legal document templates with authentic formats

export const DOCUMENT_TEMPLATES = {
  sale: {
    name: 'Sale Deed',
    template: `SALE DEED

THIS SALE DEED is made and executed on this the _____ day of _________, ${new Date().getFullYear()}

BETWEEN

Sri. {sellerName} s/o. {sellerFatherName} aged {sellerAge} years
residing at {sellerAddress} hereinafter
called the "SELLER" (which expression shall mean and include his legal heirs, successors, successors-in-interest, executors, administrators, legal representatives, attorneys and assigns) of ONE PART.

AND

Sri. {buyerName} s/o {buyerFatherName} aged {buyerAge} years
residing at {buyerAddress}
hereinafter called the "PURCHASER" which expression shall mean and include his heirs, successors, executors, administrators, legal representatives, attorneys and assigns of the OTHER PART.

WHEREAS THE SELLER is the absolute owner in possession and enjoyment of the property more fully described in the schedule hereunder and hereafter called the "SCHEDULE PROPERTY".

WHEREAS the property more fully described in the schedule hereunder is the self acquired property of the SELLER who purchased the same from {previousOwner} in and by sale deed dated {previousDeedDate} and registered as Doc.No. {docNumber} of {registrationYear} Book 1 Volume No {volumeNumber} Pages {pageFrom} to {pageTo}, registered on {registrationDate} and filed on the file of the Sub-Registrar, {registrarOffice}.

WHEREAS the SELLER is the absolute owner of the property and he has been enjoying the same with absolute right and he has clear and marketable title to the Schedule Property.

WHEREAS the SELLER being in need of funds for the purpose of {purposeOfSale} has decided to sell the property more fully described in the Schedule hereunder and the PURCHASER has offered to purchase the same.

WHEREAS the SELLER offered to sell and transfer the schedule property to the PURCHASER for a sale consideration of Rs {saleAmount} (Rupees {saleAmountWords} only) and the PURCHASER herein has agreed to purchase the same for the aforesaid consideration on the following terms and conditions:

NOW THIS SALE DEED WITNESSETH AS FOLLOWS:

1. The Sale consideration of the Schedule Property is fixed at Rs. {saleAmount} (Rupees {saleAmountWords} only).

2. The PURCHASER has paid a sum of Rs. {advanceAmount} (Rupees {advanceAmountWords} only) by cash/cheque/D.D. bearing No {chequeNumber} drawn on {bankName} dated {chequeDate} as advance, the receipt of which sum the SELLER hereby acknowledges.

3. The balance payment of Rs. {balanceAmount} (Rupees {balanceAmountWords} only) has been paid by the PURCHASER to the SELLER at the time of execution of this absolute Sale Deed and thus completing the Sale transaction.

4. The SELLER confirms with the PURCHASER that he/she has not entered into any agreement for sale, mortgage or exchange whatsoever with any other person relating to the Schedule Property of this Sale Deed.

5. The SELLER hereby assures the PURCHASER that he/she has absolute power to convey the same and there are no encumbrances, liens, charges, Government dues, attachments, acquisition, or requisition proceedings etc.

6. The SELLER agrees to put the purchaser in absolute and vacant possession of the schedule property after executing this sale deed and registering the same in the jurisdictional Sub-Registrar's office.

7. The SELLER covenants with the purchaser that he/she shall not do any act, deed or thing creating any charge, lien or encumbrance in respect of the schedule property.

8. The SELLER has specifically agreed and covenants with the PURCHASER that he/she shall do all acts, deeds and things which are necessary and requisite to convey absolute and marketable title in respect of the schedule property in favour of the PURCHASER.

9. IT IS AGREED between the parties that all expenses towards Stamp Duty and Registration charges shall be borne by the PURCHASER only.

10. The SELLER has agreed to get consent deed duly executed to this Sale transaction from his wife/her husband, sons and daughters and assured that they all join to execute this sale deed in favour of the purchaser.

11. It is hereby expressly provided and agreed by the parties here to that both parties are entitled to enforce specific performance of this deed against each other in case of breach of any conditions mentioned in this Sale Deed.

SCHEDULE OF PROPERTY

{propertyDescription}

Survey No: {surveyNumber}
Sub-Division: {subDivision}
Village: {village}
Taluk: {taluk}
District: {district}
State: {state}
Area: {propertyArea}
Boundaries:
North: {northBoundary}
South: {southBoundary}
East: {eastBoundary}
West: {westBoundary}

IN WITNESS WHEREOF the SELLER and the PURCHASER have signed this Sale Deed on the day month and year herein above mentioned in the presence of the witnesses:

WITNESSES:

1. _________________________     SELLER: _________________________
   Name: {witness1Name}           {sellerName}
   Address: {witness1Address}

2. _________________________     PURCHASER: _________________________
   Name: {witness2Name}           {buyerName}
   Address: {witness2Address}`
  },

  rent: {
    name: 'Leave and License Agreement',
    template: `LEAVE AND LICENSE AGREEMENT

THIS LEAVE AND LICENSE AGREEMENT is made and executed on this the _____ day of _________, ${new Date().getFullYear()}

BETWEEN

{landlordName}, aged {landlordAge} years, s/o {landlordFatherName}, r/o {landlordAddress}, PAN: {landlordPan}, Aadhaar: {landlordAadhaar}, hereinafter called the "LICENSOR" (which expression shall mean and include his heirs, successors, executors, administrators and assigns) of the ONE PART.

AND

{tenantName}, aged {tenantAge} years, s/o {tenantFatherName}, r/o {tenantAddress}, PAN: {tenantPan}, Aadhaar: {tenantAadhaar}, hereinafter called the "LICENSEE" (which expression shall mean and include his heirs, successors, executors, administrators and assigns) of the OTHER PART.

WHEREAS the LICENSOR is the absolute owner of the premises described in the Schedule hereunder written and is desirous of giving the same on Leave and License basis.

WHEREAS the LICENSEE has approached the LICENSOR for taking the said premises on Leave and License basis for residential purposes and the LICENSOR has agreed to grant the same on the terms and conditions hereinafter mentioned.

NOW THIS AGREEMENT WITNESSETH AS FOLLOWS:

1. The LICENSOR hereby grants to the LICENSEE, leave and license to use and occupy the premises described in the Schedule hereunder for residential purposes only for a period of {leasePeriod} months commencing from {startDate} and ending on {endDate}.

2. The monthly license fee for the said premises is fixed at Rs. {monthlyRent} (Rupees {monthlyRentWords} only) payable in advance on or before the {rentDueDate} of each English calendar month.

3. The LICENSEE has paid a sum of Rs. {securityDeposit} (Rupees {securityDepositWords} only) as interest-free refundable security deposit, the receipt of which the LICENSOR hereby acknowledges.

4. The LICENSEE shall pay electricity charges, water charges, and other utility charges as per actual consumption directly to the concerned authorities.

5. The LICENSEE shall pay maintenance charges of Rs. {maintenanceCharges} per month to the society/association.

6. The LICENSEE shall not sub-let, assign, or part with the possession of the licensed premises or any part thereof to any third party.

7. The LICENSEE shall use the premises only for residential purposes and shall not carry on any trade, business, or profession therein.

8. The LICENSEE shall maintain the premises in good and tenantable condition and shall be responsible for any damage caused due to negligence.

9. The LICENSEE shall not make any structural alterations or additions to the premises without prior written consent of the LICENSOR.

10. Either party may terminate this agreement by giving {noticePeriod} days prior written notice to the other party.

11. On termination of this agreement, the LICENSEE shall peacefully hand over vacant possession of the premises to the LICENSOR.

12. The security deposit shall be refunded without interest within 30 days of vacation after adjusting any dues.

13. This agreement shall be governed by the laws of India and courts at {jurisdiction} shall have exclusive jurisdiction.

SCHEDULE OF PROPERTY

Flat No. {flatNumber}, {buildingName}, {propertyAddress}
Built-up Area: {builtUpArea} sq.ft.
Carpet Area: {carpetArea} sq.ft.
Parking: {parkingDetails}

IN WITNESS WHEREOF both parties have signed this agreement in the presence of witnesses on the day, month and year first hereinabove written.

WITNESSES:                          LICENSOR: {landlordName}

1. {witness1Name}                   LICENSEE: {tenantName}
   {witness1Address}

2. {witness2Name}
   {witness2Address}`
  },

  partnership: {
    name: 'Partnership Deed',
    template: `PARTNERSHIP DEED

THIS PARTNERSHIP DEED is made and executed on this the _____ day of _________, ${new Date().getFullYear()}

BETWEEN

{partner1Name}, aged {partner1Age} years, s/o {partner1FatherName}, r/o {partner1Address}, PAN: {partner1Pan}, hereinafter called "FIRST PARTNER" of the ONE PART.

AND

{partner2Name}, aged {partner2Age} years, s/o {partner2FatherName}, r/o {partner2Address}, PAN: {partner2Pan}, hereinafter called "SECOND PARTNER" of the OTHER PART.

WHEREAS both parties desire to enter into partnership for carrying on the business of {businessNature} and have agreed to the terms and conditions hereinafter mentioned.

NOW THIS DEED WITNESSETH AS FOLLOWS:

1. NAME AND BUSINESS: The partnership firm shall be known as "{firmName}" and shall carry on the business of {businessNature} at {businessAddress}.

2. COMMENCEMENT: The partnership shall commence from {commencementDate} and shall continue until terminated in accordance with the terms of this deed.

3. CAPITAL CONTRIBUTION:
   a) First Partner shall contribute Rs. {partner1Capital} (Rupees {partner1CapitalWords} only)
   b) Second Partner shall contribute Rs. {partner2Capital} (Rupees {partner2CapitalWords} only)
   Total Capital: Rs. {totalCapital}

4. PROFIT AND LOSS SHARING: The profits and losses of the firm shall be shared between the partners in the ratio of {profitSharingRatio}.

5. DRAWINGS: Each partner shall be entitled to draw a sum not exceeding Rs. {monthlyDrawing} per month for personal expenses.

6. MANAGEMENT: Both partners shall have equal rights in the management and conduct of the business of the firm.

7. DUTIES OF PARTNERS:
   a) Each partner shall devote his whole time and attention to the business of the firm.
   b) No partner shall engage in any other business without consent of other partner.
   c) All partners shall act in good faith and in the best interest of the firm.

8. BANKING: All monies of the firm shall be deposited in the name of the firm in {bankName}, {bankBranch}.

9. BOOKS OF ACCOUNTS: Proper books of accounts shall be maintained at the principal place of business and each partner shall have access to the same.

10. ANNUAL ACCOUNTS: The accounts of the firm shall be closed on 31st March every year and audited by a Chartered Accountant.

11. RETIREMENT: Any partner may retire from the firm by giving {retirementNotice} months written notice.

12. DEATH OF PARTNER: In case of death of any partner, the firm shall not be dissolved and the legal heirs of the deceased partner shall be entitled to his share.

13. DISSOLUTION: The firm may be dissolved by mutual consent of all partners or as per provisions of the Indian Partnership Act, 1932.

14. ARBITRATION: Any dispute arising between the partners shall be settled by arbitration under the Arbitration and Conciliation Act, 2015.

IN WITNESS WHEREOF the parties have signed this Partnership Deed on the day, month and year first hereinabove written.

FIRST PARTNER: {partner1Name}

SECOND PARTNER: {partner2Name}

WITNESSES:
1. {witness1Name}
   {witness1Address}

2. {witness2Name}
   {witness2Address}`
  },

  employment: {
    name: 'Employment Agreement',
    template: `EMPLOYMENT AGREEMENT

THIS EMPLOYMENT AGREEMENT is made and executed on this the _____ day of _________, ${new Date().getFullYear()}

BETWEEN

{companyName}, a company incorporated under the Companies Act, 2013, having its registered office at {companyAddress}, CIN: {companyCin}, hereinafter called the "COMPANY" (which expression shall mean and include its successors and assigns) of the ONE PART.

AND

{employeeName}, aged {employeeAge} years, s/o {employeeFatherName}, r/o {employeeAddress}, PAN: {employeePan}, Aadhaar: {employeeAadhaar}, hereinafter called the "EMPLOYEE" of the OTHER PART.

WHEREAS the COMPANY desires to employ the EMPLOYEE and the EMPLOYEE agrees to work for the COMPANY on the terms and conditions hereinafter set forth.

NOW THIS AGREEMENT WITNESSETH AS FOLLOWS:

1. APPOINTMENT: The EMPLOYEE is appointed as {designation} in the {department} department of the COMPANY with effect from {joiningDate}.

2. PROBATION: The EMPLOYEE shall be on probation for a period of {probationPeriod} months from the date of joining, which may be extended at the discretion of the COMPANY.

3. SALARY AND BENEFITS:
   a) Basic Salary: Rs. {basicSalary} per month
   b) House Rent Allowance: Rs. {hra} per month
   c) Conveyance Allowance: Rs. {conveyanceAllowance} per month
   d) Medical Allowance: Rs. {medicalAllowance} per month
   e) Other Allowances: Rs. {otherAllowances} per month
   Total Monthly Salary: Rs. {totalSalary}

4. WORKING HOURS: The normal working hours shall be {workingHours} hours per day from {startTime} to {endTime}, {workingDays} days per week.

5. DUTIES AND RESPONSIBILITIES: The EMPLOYEE shall perform such duties as may be assigned by the management from time to time and shall work to the best of his ability.

6. LEAVE ENTITLEMENT:
   a) Earned Leave: {earnedLeave} days per year
   b) Casual Leave: {casualLeave} days per year
   c) Sick Leave: {sickLeave} days per year
   d) Maternity/Paternity Leave: As per applicable law

7. CONFIDENTIALITY: The EMPLOYEE shall maintain strict confidentiality regarding all business information, trade secrets, and proprietary information of the COMPANY.

8. NON-COMPETE: During the term of employment and for a period of {nonCompetePeriod} months thereafter, the EMPLOYEE shall not engage in any competing business.

9. TERMINATION:
   a) By Company: {companyNotice} months notice or salary in lieu thereof
   b) By Employee: {employeeNotice} months notice
   c) Summary dismissal for misconduct without notice

10. PROVIDENT FUND: The EMPLOYEE shall be covered under the Employees' Provident Fund Scheme as per applicable law.

11. GRATUITY: The EMPLOYEE shall be entitled to gratuity as per the Payment of Gratuity Act, 1972.

12. GOVERNING LAW: This agreement shall be governed by Indian laws and courts at {jurisdiction} shall have exclusive jurisdiction.

IN WITNESS WHEREOF the parties have signed this agreement on the day, month and year first hereinabove written.

FOR {companyName}:                  EMPLOYEE:

{authorizedSignatory}               {employeeName}
(Authorized Signatory)
Designation: {signatoryDesignation}

WITNESSES:
1. {witness1Name}
2. {witness2Name}`
  },

  nda: {
    name: 'Non-Disclosure Agreement',
    template: `NON-DISCLOSURE AGREEMENT

THIS NON-DISCLOSURE AGREEMENT is made and executed on this the _____ day of _________, ${new Date().getFullYear()}

BETWEEN

{disclosingParty}, r/o {disclosingPartyAddress}, PAN: {disclosingPartyPan}, hereinafter called the "DISCLOSING PARTY" (which expression shall mean and include its successors and assigns) of the ONE PART.

AND

{receivingParty}, r/o {receivingPartyAddress}, PAN: {receivingPartyPan}, hereinafter called the "RECEIVING PARTY" (which expression shall mean and include its successors and assigns) of the OTHER PART.

WHEREAS the DISCLOSING PARTY possesses certain confidential and proprietary information, trade secrets, technical data, and know-how relating to {informationNature}.

WHEREAS the RECEIVING PARTY desires to receive such confidential information for the purpose of {purpose} and has agreed to maintain confidentiality on the terms hereinafter mentioned.

NOW THIS AGREEMENT WITNESSETH AS FOLLOWS:

1. CONFIDENTIAL INFORMATION: For the purpose of this Agreement, "Confidential Information" shall mean all information, data, materials, documents, specifications, software, source codes, object codes, designs, drawings, processes, procedures, formulas, techniques, methods, ideas, concepts, know-how, trade secrets, and any other proprietary information disclosed by the DISCLOSING PARTY.

2. NON-DISCLOSURE OBLIGATION: The RECEIVING PARTY agrees:
   a) To hold all Confidential Information in strict confidence
   b) Not to disclose any Confidential Information to any third party
   c) Not to use Confidential Information for any purpose other than {purpose}
   d) To take reasonable precautions to prevent unauthorized disclosure

3. EXCEPTIONS: The obligations under this Agreement shall not apply to information that:
   a) Is or becomes publicly available through no breach of this Agreement
   b) Was known to the RECEIVING PARTY prior to disclosure
   c) Is independently developed without use of Confidential Information
   d) Is required to be disclosed by law or court order

4. RETURN OF INFORMATION: Upon termination of this Agreement or upon request by the DISCLOSING PARTY, the RECEIVING PARTY shall return or destroy all documents and materials containing Confidential Information.

5. NO LICENSE: No license or right is granted to the RECEIVING PARTY under any patent, copyright, trademark, or other intellectual property right.

6. TERM: This Agreement shall remain in effect for a period of {agreementTerm} years from the date of execution, unless terminated earlier.

7. REMEDIES: The RECEIVING PARTY acknowledges that breach of this Agreement may cause irreparable harm to the DISCLOSING PARTY, entitling it to seek injunctive relief in addition to other remedies.

8. GOVERNING LAW: This Agreement shall be governed by Indian laws and courts at {jurisdiction} shall have exclusive jurisdiction.

9. ENTIRE AGREEMENT: This Agreement constitutes the entire agreement between the parties and supersedes all prior negotiations, representations, or agreements.

IN WITNESS WHEREOF the parties have signed this Agreement on the day, month and year first hereinabove written.

DISCLOSING PARTY: {disclosingParty}

RECEIVING PARTY: {receivingParty}

WITNESSES:
1. {witness1Name}
   {witness1Address}

2. {witness2Name}
   {witness2Address}`
  },

  loan: {
    name: 'Loan Agreement',
    template: `LOAN AGREEMENT

THIS LOAN AGREEMENT is made and executed on this the _____ day of _________, ${new Date().getFullYear()}

BETWEEN

{lenderName}, aged {lenderAge} years, s/o {lenderFatherName}, r/o {lenderAddress}, PAN: {lenderPan}, hereinafter called the "LENDER" (which expression shall mean and include his heirs, successors, executors, administrators and assigns) of the ONE PART.

AND

{borrowerName}, aged {borrowerAge} years, s/o {borrowerFatherName}, r/o {borrowerAddress}, PAN: {borrowerPan}, hereinafter called the "BORROWER" (which expression shall mean and include his heirs, successors, executors, administrators and assigns) of the OTHER PART.

WHEREAS the BORROWER has requested the LENDER for a loan of Rs. {loanAmount} (Rupees {loanAmountWords} only) for the purpose of {loanPurpose}.

WHEREAS the LENDER has agreed to advance the said amount to the BORROWER on the terms and conditions hereinafter mentioned.

NOW THIS AGREEMENT WITNESSETH AS FOLLOWS:

1. LOAN AMOUNT: The LENDER agrees to advance a sum of Rs. {loanAmount} (Rupees {loanAmountWords} only) to the BORROWER on the execution of this Agreement.

2. PURPOSE: The loan amount shall be utilized by the BORROWER solely for {loanPurpose} and for no other purpose whatsoever.

3. INTEREST RATE: The loan shall carry simple interest at the rate of {interestRate}% per annum calculated on monthly basis.

4. REPAYMENT TERMS:
   a) The loan shall be repaid in {numberOfInstallments} equal monthly installments of Rs. {emiAmount} each
   b) The first installment shall be due on {firstInstallmentDate}
   c) Subsequent installments shall be due on the same date of each month thereafter

5. MODE OF REPAYMENT: All payments shall be made by the BORROWER to the LENDER by cash/cheque/bank transfer at {repaymentAddress}.

6. PREPAYMENT: The BORROWER may prepay the entire outstanding amount or any part thereof without any prepayment penalty by giving {prepaymentNotice} days prior written notice.

7. DEFAULT: In case of default in payment of any installment for more than {gracePeriod} days, the entire outstanding amount along with interest shall become immediately due and payable.

8. SECURITY: This loan is secured by:
   {securityDetails}

9. GUARANTOR: {guarantorName}, s/o {guarantorFatherName}, r/o {guarantorAddress}, hereby guarantees the due performance of this Agreement by the BORROWER.

10. INSURANCE: The BORROWER shall keep the security/collateral adequately insured against fire, theft, and other risks.

11. LEGAL EXPENSES: All legal expenses incurred for recovery of the loan amount shall be borne by the BORROWER.

12. JURISDICTION: Any dispute arising out of this Agreement shall be subject to the jurisdiction of courts at {jurisdiction}.

13. STAMP DUTY: The stamp duty on this Agreement shall be borne by the BORROWER.

IN WITNESS WHEREOF the parties have signed this Agreement on the day, month and year first hereinabove written.

LENDER: {lenderName}

BORROWER: {borrowerName}

GUARANTOR: {guarantorName}

WITNESSES:
1. {witness1Name}
   {witness1Address}

2. {witness2Name}
   {witness2Address}`
  }
}

export async function generateDocument(type: string, inputs: Record<string, string>): Promise<string> {
  const template = DOCUMENT_TEMPLATES[type as keyof typeof DOCUMENT_TEMPLATES]
  if (!template) {
    throw new Error('Invalid document type')
  }

  console.log('ðŸ”§ Generating document with inputs:', inputs)
  
  // Enhanced template replacement with better data mapping
  let document = template.template
  const currentDate = new Date()
  
  // Add intelligent defaults based on document type
  const enhancedInputs = {
    ...inputs,
    currentDate: currentDate.toLocaleDateString('en-IN'),
    currentDay: currentDate.getDate().toString(),
    currentMonth: currentDate.toLocaleDateString('en-IN', { month: 'long' }),
    currentYear: currentDate.getFullYear().toString()
  }
  
  // Document-specific intelligent filling
  if (type === 'rent') {
    enhancedInputs.endDate = enhancedInputs.startDate ? 
      new Date(new Date(enhancedInputs.startDate).getTime() + (parseInt(enhancedInputs.leasePeriod || '11') * 30 * 24 * 60 * 60 * 1000)).toLocaleDateString('en-IN') : 
      '_____________'
    enhancedInputs.rentDueDate = '5th'
    enhancedInputs.noticePeriod = '30'
    enhancedInputs.jurisdiction = 'Delhi'
  }
  
  if (type === 'sale') {
    const amount = parseInt(enhancedInputs.saleAmount || '0')
    const advance = parseInt(enhancedInputs.advanceAmount || '0')
    enhancedInputs.balanceAmount = (amount - advance).toString()
    enhancedInputs.saleAmountWords = numberToWords(amount)
    enhancedInputs.advanceAmountWords = numberToWords(advance)
    enhancedInputs.balanceAmountWords = numberToWords(amount - advance)
  }
  
  if (type === 'loan') {
    const amount = parseInt(enhancedInputs.loanAmount || '0')
    const rate = parseFloat(enhancedInputs.interestRate || '12')
    const tenure = parseInt(enhancedInputs.numberOfInstallments || '12')
    const emi = Math.round((amount * rate * Math.pow(1 + rate/100/12, tenure)) / (Math.pow(1 + rate/100/12, tenure) - 1))
    enhancedInputs.emiAmount = emi.toString()
    enhancedInputs.loanAmountWords = numberToWords(amount)
  }
  
  // Replace all placeholders with enhanced data
  for (const [key, value] of Object.entries(enhancedInputs)) {
    if (value && value.trim()) {
      const regex = new RegExp(`\\{${key}\\}`, 'gi')
      document = document.replace(regex, value)
    }
  }
  
  // Try AI enhancement if API key available
  try {
    if (process.env.GEMINI_API_KEY) {
      const { GoogleGenerativeAI } = await import('@google/generative-ai')
      const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY)
      const model = genAI.getGenerativeModel({ model: 'gemini-1.5-flash' })

      const prompt = `Enhance this ${template.name} document by filling remaining blanks intelligently:

${document}

User provided data:
${Object.entries(inputs).map(([k, v]) => `${k}: ${v}`).join('\n')}

Instructions:
1. Fill any remaining blanks with appropriate legal content
2. Ensure all user data is properly integrated
3. Keep the legal format intact
4. Return ONLY the complete document`

      const result = await model.generateContent(prompt)
      const aiEnhanced = result.response.text()
      
      if (aiEnhanced && aiEnhanced.length > document.length * 0.8) {
        document = aiEnhanced
      }
    }
  } catch (error) {
    console.warn('AI enhancement failed:', error)
  }
  
  // Final cleanup - replace any remaining placeholders
  document = document.replace(/\{[^}]+\}/g, '_____________')
  document = document.replace(/_____+/g, '_____________')
  
  console.log('âœ… Document generated successfully')
  return document
}

// Helper function to convert numbers to words
function numberToWords(num: number): string {
  if (num === 0) return 'Zero'
  
  const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine']
  const teens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen']
  const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety']
  
  if (num < 10) return ones[num]
  if (num < 20) return teens[num - 10]
  if (num < 100) return tens[Math.floor(num / 10)] + (num % 10 ? ' ' + ones[num % 10] : '')
  if (num < 1000) return ones[Math.floor(num / 100)] + ' Hundred' + (num % 100 ? ' ' + numberToWords(num % 100) : '')
  if (num < 100000) return numberToWords(Math.floor(num / 1000)) + ' Thousand' + (num % 1000 ? ' ' + numberToWords(num % 1000) : '')
  if (num < 10000000) return numberToWords(Math.floor(num / 100000)) + ' Lakh' + (num % 100000 ? ' ' + numberToWords(num % 100000) : '')
  
  return numberToWords(Math.floor(num / 10000000)) + ' Crore' + (num % 10000000 ? ' ' + numberToWords(num % 10000000) : '')
}