<!DOCTYPE html>
<html>
<head>
    <title>Test Fresh API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .form-group { margin: 10px 0; }
        input, textarea { width: 300px; padding: 8px; margin: 5px 0; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        .result { margin-top: 20px; padding: 20px; background: #f8f9fa; border: 1px solid #ddd; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üß™ Test Fresh Document API</h1>
    
    <div class="form-group">
        <label>Document Type:</label>
        <select id="docType">
            <option value="sale">Sale Deed</option>
            <option value="rent">Rental Agreement</option>
        </select>
    </div>
    
    <div class="form-group">
        <label>Seller/Landlord Name:</label>
        <input type="text" id="name1" value="Rajesh Kumar" />
    </div>
    
    <div class="form-group">
        <label>Buyer/Tenant Name:</label>
        <input type="text" id="name2" value="Priya Sharma" />
    </div>
    
    <div class="form-group">
        <label>Property/Amount:</label>
        <input type="text" id="property" value="Flat 301, Green Valley Apartments" />
    </div>
    
    <div class="form-group">
        <label>Amount/Rent:</label>
        <input type="text" id="amount" value="5000000" />
    </div>
    
    <button onclick="testAPI()">üöÄ Generate Document</button>
    
    <div id="result" class="result" style="display:none;">
        <h3>Generated Document:</h3>
        <pre id="document"></pre>
    </div>

    <script>
        async function testAPI() {
            const type = document.getElementById('docType').value;
            const name1 = document.getElementById('name1').value;
            const name2 = document.getElementById('name2').value;
            const property = document.getElementById('property').value;
            const amount = document.getElementById('amount').value;
            
            let inputs = {};
            
            if (type === 'sale') {
                inputs = {
                    sellerName: name1,
                    buyerName: name2,
                    propertyDescription: property,
                    saleAmount: amount,
                    advanceAmount: '500000',
                    sellerAddress: 'House No. 123, Sector 10, Gurgaon',
                    buyerAddress: 'House No. 456, Sector 20, Gurgaon'
                };
            } else {
                inputs = {
                    landlordName: name1,
                    tenantName: name2,
                    propertyAddress: property,
                    monthlyRent: amount,
                    securityDeposit: '100000',
                    leasePeriod: '11 months'
                };
            }
            
            console.log('üß™ Testing with:', { type, inputs });
            
            try {
                const response = await fetch('/api/drafts-fresh', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Cache-Control': 'no-cache'
                    },
                    body: JSON.stringify({ type, inputs })
                });
                
                const data = await response.json();
                console.log('üì• Response:', data);
                
                if (data.ok && data.content) {
                    document.getElementById('document').textContent = data.content;
                    document.getElementById('result').style.display = 'block';
                } else {
                    alert('‚ùå Error: ' + (data.error || 'Failed to generate'));
                }
            } catch (error) {
                console.error('‚ùå Error:', error);
                alert('‚ùå Network error: ' + error.message);
            }
        }
    </script>
</body>
</html>